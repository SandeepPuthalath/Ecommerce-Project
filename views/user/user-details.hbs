<link href="/assets/css/main.css" rel="stylesheet" type="text/css" />
<main class="main">
    <div class="page-header breadcrumb-wrap">
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html" rel="nofollow">Home</a>
                <span></span> Pages
                <span></span> Account
            </div>
        </div>
    </div>
    <section class="pt-50 pb-50">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 m-auto">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="dashboard-menu">
                                <ul class="nav flex-column" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link active" id="dashboard-tab" data-bs-toggle="tab"
                                            href="#dashboard" role="tab" aria-controls="dashboard"
                                            aria-selected="false"><i
                                                class="fi-rs-settings-sliders mr-10"></i>Dashboard</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="orders-tab" data-bs-toggle="tab" href="#orders"
                                            role="tab" aria-controls="orders" aria-selected="false"><i
                                                class="fi-rs-shopping-bag mr-10"></i>Orders</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="orders-tab" data-bs-toggle="tab" href="#history"
                                            role="tab" aria-controls="history" aria-selected="false"><i
                                                class="fi-rs-shopping-bag mr-10"></i>Orders History</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="track-orders-tab" data-bs-toggle="tab"
                                            href="#track-orders" role="tab" aria-controls="track-orders"
                                            aria-selected="false"><i class="fi-rs-shopping-cart-check mr-10"></i>Track
                                            Your Order</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="address-tab" data-bs-toggle="tab" href="#address"
                                            role="tab" aria-controls="address" aria-selected="true"><i
                                                class="fi-rs-marker mr-10"></i>My Address</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="account-detail-tab" data-bs-toggle="tab"
                                            href="#account-detail" role="tab" aria-controls="account-detail"
                                            aria-selected="true"><i class="fi-rs-user mr-10"></i>Account details</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="/logout"><i
                                                class="fi-rs-sign-out mr-10"></i>Logout</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-9">
                            <div class="tab-content dashboard-content">
                                <div class="tab-pane fade active show" id="dashboard" role="tabpanel"
                                    aria-labelledby="dashboard-tab">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0">Hello {{user.name}}! </h5>
                                        </div>
                                        <div class="card-body">
                                            <p>From your account dashboard. you can easily check &amp; view your <a
                                                    href="#">recent orders</a>, manage your <a href="#">shipping and
                                                    billing addresses</a> and <a href="#">edit your password and account
                                                    details.</a></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="history" role="tabpanel" aria-labelledby="history-tab">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0">Orders History</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="table-responsive">
                                                <table class="table">
                                                    <thead>
                                                        <tr>
                                                            <th>Order</th>
                                                            <th>Date</th>
                                                            <th>Expect</th>
                                                            <th>Total</th>
                                                            <th>Status</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {{#each orderHistory}}
                                                        <tr id="{{this._id}}">
                                                            <td>{{this._id}}</td>
                                                            <td>{{this.dateOfOrder}}</td>
                                                            <td>{{this.dateOfFullfilment}}</td>
                                                            <td>Rs. {{this.totalAmount}}</td>
                                                            <td>{{this.status}}</td>
                                                        </tr>
                                                        {{/each}}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="orders" role="tabpanel" aria-labelledby="history-tab">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0">Your Orders</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="table-responsive">
                                                <table class="table">
                                                    <thead>
                                                        <tr>
                                                            <th>Sl.No</th>
                                                            <th>Order</th>
                                                            <th>Date</th>
                                                            <th>Expect</th>
                                                            <th>Total</th>
                                                            <th>Status</th>
                                                            <th>Actions</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {{#each orderDetails}}
                                                        <tr id="{{this._id}}">
                                                            <td>{{inc @index}}</td>
                                                            <td>{{this._id}}</td>
                                                            <td>{{this.dateOfOrder}}</td>
                                                            <td>{{this.dateOfFullfilment}}</td>
                                                            <td>Rs. {{this.totalAmount}}</td>
                                                            <td>{{this.status}}</td>
                                                            {{!-- <td><button onclick="cancelOrder('{{this._id}}')"
                                                                    class=" btn btn-sm d-block">Cancel</button></td>
                                                            --}}
                                                            <td>
                                                                <ul class="nav flex-column" role="tablist">
                                                                    <li class="nav-item">
                                                                        <a data-value="{{this._id}}" class="nav-link"
                                                                            id="orderDetails-tab" data-bs-toggle="tab"
                                                                            href="#orderDetails" role="tab"
                                                                            aria-controls="orderDetails"
                                                                            aria-selected="false"
                                                                            class="btn-small d-block">View</a>
                                                                    </li>
                                                                </ul>
                                                            </td>
                                                        </tr>
                                                        {{/each}}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="track-orders" role="tabpanel"
                                    aria-labelledby="track-orders-tab">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0">Orders tracking</h5>
                                        </div>
                                        <div class="card-body contact-from-area">
                                            <p>To track your order please enter your OrderID in the box below and press
                                                "Track" button. This was given to you on your receipt and in the
                                                confirmation email you should have received.</p>
                                            <div class="row">
                                                <div class="col-lg-8">
                                                    <form class="contact-form-style mt-30 mb-50" action="#"
                                                        method="post">
                                                        <div class="input-style mb-20">
                                                            <label>Order ID</label>
                                                            <input name="order-id"
                                                                placeholder="Found in your order confirmation email"
                                                                type="text" class="square">
                                                        </div>
                                                        <div class="input-style mb-20">
                                                            <label>Billing email</label>
                                                            <input name="billing-email"
                                                                placeholder="Email you used during checkout"
                                                                type="email" class="square">
                                                        </div>
                                                        <button class="submit submit-auto-width"
                                                            type="submit">Track</button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="address" role="tabpanel" aria-labelledby="address-tab">
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="card mb-3 mb-lg-0">
                                                <div class="card-header">
                                                    <h5 class="mb-0">Billing Address</h5>
                                                </div>
                                                <div class="card-body">
                                                    <address>3522 Interstate<br> 75 Business Spur,<br> Sault Ste.
                                                        <br>Marie, MI 49783
                                                    </address>
                                                    <p>New York</p>
                                                    <a href="#" class="btn-small">Edit</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="card">
                                                <div class="card-header">
                                                    <h5 class="mb-0">Shipping Address</h5>
                                                </div>
                                                <div class="card-body">
                                                    <address>4299 Express Lane<br>
                                                        Sarasota, <br>FL 34249 USA <br>Phone: 1.941.227.4444</address>
                                                    <p>Sarasota</p>
                                                    <a href="#" class="btn-small">Edit</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="account-detail" role="tabpanel"
                                    aria-labelledby="account-detail-tab">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5>Account Details</h5>
                                        </div>
                                        <div class="card-body">
                                            <p>Already have an account? <a href="page-login-register.html">Log in
                                                    instead!</a></p>
                                            <form method="post" name="enq">
                                                <div class="row">
                                                    <div class="form-group col-md-6">
                                                        <label>First Name <span class="required">*</span></label>
                                                        <input required="" class="form-control square" name="name"
                                                            type="text">
                                                    </div>
                                                    <div class="form-group col-md-6">
                                                        <label>Last Name <span class="required">*</span></label>
                                                        <input required="" class="form-control square" name="phone">
                                                    </div>
                                                    <div class="form-group col-md-12">
                                                        <label>Display Name <span class="required">*</span></label>
                                                        <input required="" class="form-control square" name="dname"
                                                            type="text">
                                                    </div>
                                                    <div class="form-group col-md-12">
                                                        <label>Email Address <span class="required">*</span></label>
                                                        <input required="" class="form-control square" name="email"
                                                            type="email">
                                                    </div>
                                                    <div class="form-group col-md-12">
                                                        <label>Current Password <span class="required">*</span></label>
                                                        <input required="" class="form-control square" name="password"
                                                            type="password">
                                                    </div>
                                                    <div class="form-group col-md-12">
                                                        <label>New Password <span class="required">*</span></label>
                                                        <input required="" class="form-control square" name="npassword"
                                                            type="password">
                                                    </div>
                                                    <div class="form-group col-md-12">
                                                        <label>Confirm Password <span class="required">*</span></label>
                                                        <input required="" class="form-control square" name="cpassword"
                                                            type="password">
                                                    </div>
                                                    <div class="col-md-12">
                                                        <button type="submit" class="btn btn-fill-out submit"
                                                            name="submit" value="Submit">Save</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="orderDetails" role="tabpanel"
                                    aria-labelledby="orderDetails-tab">
                                    <section class="content-main">
                                        <div class="content-header">
                                            <div>
                                                <h2 class="content-title card-title">Order detail</h2>
                                                <p>Details for Order ID: {{orderDetails._id}} </p>
                                            </div>
                                        </div>
                                        <div class="card">
                                            <header class="card-header">
                                                <div class="row align-items-center">
                                                    <div class="col-lg-6 col-md-6 mb-lg-0 mb-15">
                                                        <span>
                                                            <i class="material-icons md-calendar_today"></i>
                                                            <b>{{orderDetails.dateOfOrder}}</b>
                                                        </span>
                                                        <br />
                                                        <small class="text-muted">Order ID:{{orderDetails._id}}</small>
                                                    </div>
                                                    <div class="col-lg-6 col-md-6 ms-auto text-md-end">
                                                        <select class="form-select d-inline-block mb-lg-0 mb-15 mw-200">
                                                            <option>Change status</option>
                                                            <option>Awaiting payment</option>
                                                            <option>Confirmed</option>
                                                            <option>Shipped</option>
                                                            <option>Delivered</option>
                                                        </select>
                                                        <a class="btn btn-primary" href="#">Save</a>
                                                        <a id="invoice" class="btn btn-secondary print ms-2" href="#"><i
                                                                class="icon material-icons md-print"></i></a>
                                                    </div>
                                                </div>
                                            </header>
                                            <!-- card-header end// -->
                                            <div class="card-body">
                                                <div class="row mb-50 mt-20 order-info-wrap">
                                                    <div class="col-md-4">
                                                        <article class="icontext align-items-start">
                                                            <span class="icon icon-sm rounded-circle bg-primary-light">
                                                                <i class="text-primary material-icons md-person"></i>
                                                            </span>
                                                            <div class="text">
                                                                <h6 class="mb-1">Customer</h6>
                                                                <p class="mb-1">
                                                                    {{orderDetails.address.name}}
                                                                    <template class="__cf_email__"
                                                                        data-cfemail="e2838e879aa2879a838f928e87cc818d8f">[email&#160;protected]</template>
                                                                    <br />
                                                                    +91{{orderDetails.address.phoneNumber}}
                                                                </p>
                                                                <a href="#">View profile</a>
                                                            </div>
                                                        </article>
                                                    </div>
                                                    <!-- col// -->
                                                    <div class="col-md-4">
                                                        <article class="icontext align-items-start">
                                                            <span class="icon icon-sm rounded-circle bg-primary-light">
                                                                <i
                                                                    class="text-primary material-icons md-local_shipping"></i>
                                                            </span>
                                                            <div class="text">
                                                                <h6 class="mb-1">Order info</h6>
                                                                <p class="mb-1">
                                                                    Shipping: Fargo express
                                                                    <br />
                                                                    Pay method:
                                                                    {{orderItems.payment}}
                                                                    <br />
                                                                    Status:
                                                                    {{orderItems.status}}
                                                                </p>
                                                                <a href="#">Download info</a>
                                                            </div>
                                                        </article>
                                                    </div>
                                                    <!-- col// -->
                                                    <div class="col-md-4">
                                                        <article class="icontext align-items-start">
                                                            <span class="icon icon-sm rounded-circle bg-primary-light">
                                                                <i class="text-primary material-icons md-place"></i>
                                                            </span>
                                                            <div class="text">
                                                                <h6 class="mb-1">Deliver to</h6>
                                                                <p class="mb-1">
                                                                    City:
                                                                    {{orderDetails.address.city}}
                                                                    <br />{{orderDetails.address.address_line}}
                                                                    <br />
                                                                    {{orderDetails.address.state}}
                                                                </p>
                                                                {{! <a href="#">View profile</a> }}
                                                            </div>
                                                        </article>
                                                    </div>
                                                    <!-- col// -->
                                                </div>
                                                <!-- row // -->
                                                <div class="row">
                                                    <div class="col-lg-7">
                                                        <div class="table-responsive">
                                                            <table class="table">
                                                                <thead>
                                                                    <tr>
                                                                        <th width="40%">Product</th>
                                                                        <th width="20%">Unit Price</th>
                                                                        <th width="20%">Quantity</th>
                                                                        <th width="20%" class="text-end">Total</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    {{#each orderItems}}
                                                                    <tr>
                                                                        <td>
                                                                            <a class="itemside" href="#">
                                                                                <div class="left">
                                                                                    <img src="/product-images/{{this.product._id}}.jpg"
                                                                                        width="40" height="40"
                                                                                        class="img-xs" alt="Item" />
                                                                                </div>
                                                                                <div class="info">
                                                                                    {{this.product.product_name}}</div>
                                                                            </a>
                                                                        </td>
                                                                        <td><span
                                                                                id="product_{{this.product.product_price}}">{{this.product.product_price}}</span>
                                                                        </td>
                                                                        <td><span
                                                                                id="quantity_{{this.quantity}}">{{this.quantity}}</span>
                                                                        </td>
                                                                        <td class="text-end">₹ <span>{{mult
                                                                                this.product.product_price
                                                                                this.quantity}}</span></td>
                                                                    </tr>
                                                                    {{/each}}
                                                                    <tr>
                                                                        <td colspan="4">
                                                                            <hr>
                                                                            <article class="float-end">
                                                                                <dl class="dlist">
                                                                                    <dt>Subtotal:</dt>
                                                                                    <dd>$<b
                                                                                            id="subTotal">{{orderDetails.totalAmount}}</b>
                                                                                    </dd>
                                                                                </dl>
                                                                                <dl class="dlist">
                                                                                    <dt>Coupon discount:</dt>
                                                                                    <dd>$<b id="discount">10.00</b></dd>
                                                                                </dl>
                                                                                <dl class="dlist">
                                                                                    <dt>Grand total:</dt>
                                                                                    <dd><b class="h5">$</b><b
                                                                                            id="grandTotal"
                                                                                            class="h5"></b> </dd>
                                                                                </dl>
                                                                                <dl class="dlist">
                                                                                    <dt class="text-muted">Status:</dt>
                                                                                    <dd>
                                                                                        <span
                                                                                            class="badge rounded-pill alert-success text-success">Payment
                                                                                            done</span>
                                                                                    </dd>
                                                                                </dl>
                                                                            </article>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <!-- table-responsive// -->
                                                    </div>
                                                    <!-- col// -->
                                                    <div class="col-lg-1"></div>
                                                    <div class="col-lg-4">
                                                        <div class="h-25 pt-4">
                                                            <div class="mb-3">
                                                                <label>Notes</label>
                                                                <textarea class="form-control" name="notes" id="notes"
                                                                    placeholder="Type some note"></textarea>
                                                            </div>
                                                            <button class="btn btn-primary">Save note</button>
                                                        </div>
                                                    </div>
                                                    <!-- col// -->
                                                </div>
                                            </div>
                                            <!-- card-body end// -->
                                        </div>
                                        <!-- card end// -->
                                    </section>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </section>
</main>

<script>
    $(document).ready(function () {
        $("#orderDetails-tab").click((e) => {
            e.preventDefault();
            console.log('clicked')
            const orderId = $('#orderDetails-tab').data('value');
            console.log(orderId)
            $.ajax({
                url: '/api/user/settings/' + orderId,
                type: 'get'
            }).done((res) => {

            })
        })
        $('#invoice').click((e) => {
            console.log('clicked')
            e.preventDefault();
            swal("Are you sure you want to do this?", {
                buttons: ["Oh noez!", true],
            }).then((res) => {
                if (res) {
                    var data = {
                        // Customize enables you to provide your own templates
                        // Please review the documentation for instructions and examples
                        "customize": {
                            //  "template": fs.readFileSync('template.html', 'base64') // Must be base64 encoded html 
                        },
                        "images": {
                            // The logo on top of your invoice
                            "logo": "https://public.easyinvoice.cloud/img/logo_en_original.png",
                            // The invoice background
                            "background": "https://public.easyinvoice.cloud/img/watermark-draft.jpg"
                        },
                        // Your own data
                        "sender": {
                            "company": "Sample Corp",
                            "address": "Sample Street 123",
                            "zip": "1234 AB",
                            "city": "Sampletown",
                            "country": "Samplecountry"
                            //"custom1": "custom value 1",
                            //"custom2": "custom value 2",
                            //"custom3": "custom value 3"
                        },
                        // Your recipient
                        "client": {
                            "company": "Client Corp",
                            "address": "Clientstreet 456",
                            "zip": "4567 CD",
                            "city": "Clientcity",
                            "country": "Clientcountry"
                            // "custom1": "custom value 1",
                            // "custom2": "custom value 2",
                            // "custom3": "custom value 3"
                        },
                        "information": {
                            // Invoice number
                            "number": "2021.0001",
                            // Invoice data
                            "date": "12-12-2021",
                            // Invoice due date
                            "due-date": "31-12-2021"
                        },
                        // The products you would like to see on your invoice
                        // Total values are being calculated automatically
                        "products": [
                            {
                                "quantity": 2,
                                "description": "Product 1",
                                "tax-rate": 6,
                                "price": 33.87
                            },
                            {
                                "quantity": 4.1,
                                "description": "Product 2",
                                "tax-rate": 6,
                                "price": 12.34
                            },
                            {
                                "quantity": 4.5678,
                                "description": "Product 3",
                                "tax-rate": 21,
                                "price": 6324.453456
                            }
                        ],
                        // The message you would like to display on the bottom of your invoice
                        "bottom-notice": "Kindly pay your invoice within 15 days.",
                        // Settings to customize your invoice
                        "settings": {
                            "currency": "USD", // See documentation 'Locales and Currency' for more info. Leave empty for no currency.
                            // "locale": "nl-NL", // Defaults to en-US, used for number formatting (See documentation 'Locales and Currency')
                            // "tax-notation": "gst", // Defaults to 'vat'
                            // "margin-top": 25, // Defaults to '25'
                            // "margin-right": 25, // Defaults to '25'
                            // "margin-left": 25, // Defaults to '25'
                            // "margin-bottom": 25, // Defaults to '25'
                            // "format": "A4", // Defaults to A4, options: A3, A4, A5, Legal, Letter, Tabloid
                            // "height": "1000px", // allowed units: mm, cm, in, px
                            // "width": "500px", // allowed units: mm, cm, in, px
                            // "orientation": "landscape", // portrait or landscape, defaults to portrait
                        },
                        // Translate your invoice to your preferred language
                        "translate": {
                            // "invoice": "FACTUUR",  // Default to 'INVOICE'
                            // "number": "Nummer", // Defaults to 'Number'
                            // "date": "Datum", // Default to 'Date'
                            // "due-date": "Verloopdatum", // Defaults to 'Due Date'
                            // "subtotal": "Subtotaal", // Defaults to 'Subtotal'
                            // "products": "Producten", // Defaults to 'Products'
                            // "quantity": "Aantal", // Default to 'Quantity'
                            // "price": "Prijs", // Defaults to 'Price'
                            // "product-total": "Totaal", // Defaults to 'Total'
                            // "total": "Totaal" // Defaults to 'Total'
                        },
                    };

                    //Create your invoice! Easy!
                    easyinvoice.createInvoice(data, function (result) {
                        //The response will contain a base64 encoded PDF file
                        easyinvoice.download('myInvoice.pdf', result.pdf);
                    });
                }
            })
        })

    })
</script>